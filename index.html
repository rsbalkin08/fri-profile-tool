<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FRI Profile Tool</title>
  <style>
    :root { --maxw: 900px; }
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      margin:0; padding:24px; display:flex; justify-content:center;
      background:#f7f7fb; color:#111;
    }
    .wrap{
      width:100%; max-width:var(--maxw);
      background:#fff; border-radius:16px;
      box-shadow:0 10px 30px rgba(0,0,0,.08);
      padding:20px 20px 26px;
    }
    h1{ margin:0 0 10px; font-size:22px; }
    p{ margin:0 0 18px; color:#444; line-height:1.45; }
    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:14px; }
    @media (max-width:760px){ .grid{ grid-template-columns:1fr; } }
    .card{
      border:1px solid #e8e8ef; border-radius:14px;
      padding:14px; background:#fff;
    }
    .muted{ color:#666; font-size:13px; }
    .inputs{ display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px; }
    .field label{ display:block; font-size:13px; color:#333; margin-bottom:6px; }
    .field input{
      width:100%; padding:10px 10px; border:1px solid #d7d7e2;
      border-radius:10px; font-size:16px; outline:none;
    }
    .field input:focus{ border-color:#2d3cff; box-shadow:0 0 0 3px rgba(45,60,255,.15); }
    .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:12px; }
    button{
      appearance:none; border:0; background:#2d3cff; color:#fff;
      padding:10px 14px; border-radius:12px; font-weight:600; cursor:pointer;
    }
    button:hover{ filter:brightness(.95); }
    .result h2{ margin:0 0 8px; font-size:18px; }
    .pill{
      display:inline-block; padding:6px 10px; border-radius:999px;
      background:#f0f2ff; border:1px solid #dfe3ff;
      font-size:13px; color:#2430c9; margin-left:8px; vertical-align:middle;
    }
    #profileName{ margin-top:6px; font-size:16px; font-weight:700; }
    #narrative{
      font-size:19px; line-height:1.6; white-space:pre-wrap;
      margin-top:10px; background:#fbfbff; border:1px solid #e7e7ff;
      border-radius:14px; padding:12px 14px;
    }
    .controls{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .controls input[type="range"]{ width:220px; }
    canvas{
      width:100%; height:280px; border:1px solid #e8e8ef;
      border-radius:14px; background:#fff;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>FRI Profile Tool</h1>
    <p>Enter your four scores to see your profile match (High ≥ 18, Low &lt; 18), narrative, and chart.</p>

    <div class="grid">
      <div class="card">
        <div class="muted">Scores (range 6–30)</div>

        <div class="inputs">
          <div class="field">
            <label for="ce">Collaborative Exploration (CE)</label>
            <input id="ce" type="number" min="0" max="30" step="1" placeholder="e.g., 20" />
          </div>
          <div class="field">
            <label for="rr">Role of Reconciliation (RR)</label>
            <input id="rr" type="number" min="0" max="30" step="1" placeholder="e.g., 20" />
          </div>
          <div class="field">
            <label for="rc">Remorse/Change (RC)</label>
            <input id="rc" type="number" min="0" max="30" step="1" placeholder="e.g., 20" />
          </div>
          <div class="field">
            <label for="out">Outcome (OUT)</label>
            <input id="out" type="number" min="0" max="30" step="1" placeholder="e.g., 20" />
          </div>
        </div>

        <div class="row">
          <button id="runBtn">Generate Profile</button>
          <span class="muted" id="status"></span>
        </div>

        <div class="controls">
          <span class="muted">Narrative font size</span>
          <input id="fontSize" type="range" min="14" max="28" value="19" />
          <span class="muted" id="fontLabel">19px</span>
        </div>
      </div>

      <div class="card result">
        <h2>Result</h2>
        <div id="profileName" class="muted">Enter scores and click “Generate Profile.”</div>
        <div id="narrative"></div>
      </div>
    </div>

    <div class="card" style="margin-top:14px;">
      <div class="muted" style="margin-bottom:10px;">Chart (y-axis 6–30)</div>
      <canvas id="chart" width="900" height="320"></canvas>
    </div>
  </div>

<script>
  // =========================
  // Profiles: YOUR provided names
  // (Codes are in order CE, RR, RC, OUT)
  // =========================
  const PROFILES = {
    "HHHH": { name: "Everything Is Awesome" },
    "LLLL": { name: "No, No, and Hell No" },
    "LLLH": { name: "I Might Need To Rethink This" },
    "HHHL": { name: "I'm Not Going To Get Over It" },
    "LHHH": { name: "I'm Trying To See The Good In This" },
    "LLHH": { name: "I'm Trying To See The Good In This" },
    "LHHL": { name: "I Just Can't See The Good In This" },
    "LHLH": { name: "Not Going To Change And This Is Unhealthy" },
    "HLLH": { name: "This Is Toxic, But I Like It" },
    "HHLH": { name: "Not Ending Over This" },
    "HLHL": { name: "I'm Just Not Into It" },
    "HLHH": { name: "I'm Kind Of Into It" },
    "HLLL": { name: "Just No" },
    "LHLL": { name: "Just No" },
    "LLHL": { name: "Just No" },
    "HHLL": { name: "Just No" }
  };

  const cutoff = 18;

  const els = {
    ce: document.getElementById("ce"),
    rr: document.getElementById("rr"),
    rc: document.getElementById("rc"),
    out: document.getElementById("out"),
    runBtn: document.getElementById("runBtn"),
    status: document.getElementById("status"),
    codePill: document.getElementById("codePill"),
    profileName: document.getElementById("profileName"),
    narrative: document.getElementById("narrative"),
    canvas: document.getElementById("chart"),
    fontSize: document.getElementById("fontSize"),
    fontLabel: document.getElementById("fontLabel"),
  };

  els.fontSize.addEventListener("input", () => {
    const px = `${els.fontSize.value}px`;
    els.narrative.style.fontSize = px;
    els.fontLabel.textContent = px;
  });

  function hlWord(v){ return v >= cutoff ? "High" : "Low"; }
  function hlLetter(v){ return v >= cutoff ? "H" : "L"; }

  // IMPORTANT: Code order is CE, RR, RC, OUT
  function buildCode(CE, RR, RC, OUT){
    return `${hlLetter(CE)}${hlLetter(RR)}${hlLetter(RC)}${hlLetter(OUT)}`;
  }

  function validateScore(v){
    if (!Number.isFinite(v)) return "Please enter all four scores.";
    if (v < 0 || v > 30) return "Scores must be between 0 and 30.";
    return null;
  }

  function makeNarrative(profileName, code, CE, RR, RC, OUT){
  return (
    `Profile: ${profileName}\n` +
    `Collaborative Exploration (CE): ${CE}\n` +
    `Role of Reconciliation (RR): ${RR}\n` +
    `Remorse/Change (RC): ${RC}\n` +
    `Outcome (OUT): ${OUT}`
  );
}


  // Simple canvas chart (y-axis 6–30)
  function drawChart(values){
    const ctx = els.canvas.getContext("2d");
    const W = els.canvas.width, H = els.canvas.height;
    ctx.clearRect(0,0,W,H);

    const padding = { left: 60, right: 30, top: 20, bottom: 50 };
    const x0 = padding.left, x1 = W - padding.right;
    const y0 = padding.top, y1 = H - padding.bottom;

    const ymin = 6, ymax = 30;
    const labels = ["CE","RR","RC","OUT"];

    // Axes
    ctx.strokeStyle = "#222";
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(x0, y0);
    ctx.lineTo(x0, y1);
    ctx.lineTo(x1, y1);
    ctx.stroke();

    // Y ticks
    ctx.font = "12px system-ui";
    const ticks = [6,12,18,24,30];
    ticks.forEach(t=>{
      const y = y1 - ((t - ymin) / (ymax - ymin)) * (y1 - y0);
      ctx.strokeStyle = "#ddd";
      ctx.beginPath();
      ctx.moveTo(x0, y);
      ctx.lineTo(x1, y);
      ctx.stroke();
      ctx.fillStyle = "#222";
      ctx.fillText(String(t), 20, y + 4);
    });

    const xs = labels.map((_, i) => x0 + (i * (x1 - x0) / (labels.length - 1)));
    const ys = values.map(v => y1 - ((v - ymin) / (ymax - ymin)) * (y1 - y0));

    // Line
    ctx.strokeStyle = "#2d3cff";
    ctx.lineWidth = 3;
    ctx.beginPath();
    ctx.moveTo(xs[0], ys[0]);
    for (let i=1;i<xs.length;i++) ctx.lineTo(xs[i], ys[i]);
    ctx.stroke();

    // Points
    ctx.fillStyle = "#2d3cff";
    for (let i=0;i<xs.length;i++){
      ctx.beginPath();
      ctx.arc(xs[i], ys[i], 5, 0, Math.PI*2);
      ctx.fill();
    }

    // X labels
    ctx.fillStyle = "#222";
    ctx.font = "14px system-ui";
    labels.forEach((lab, i) => ctx.fillText(lab, xs[i]-10, H-18));
  }

  function run(){
    els.status.textContent = "";

    const CE  = Number(els.ce.value);
    const RR  = Number(els.rr.value);
    const RC  = Number(els.rc.value);
    const OUT = Number(els.out.value);

    const err = validateScore(CE) || validateScore(RR) || validateScore(RC) || validateScore(OUT);
    if (err){
      els.status.textContent = err;
      els.codePill.textContent = "CODE: —";
      els.profileName.textContent = "—";
      els.narrative.textContent = "";
      drawChart([6,6,6,6]);
      return;
    }

    const code = buildCode(CE, RR, RC, OUT);
    

    const prof = PROFILES[code];
    const profileName = prof ? prof.name : "No matching profile";

    els.profileName.textContent = profileName;
    els.narrative.textContent = makeNarrative(profileName, code, CE, RR, RC, OUT);
    drawChart([CE, RR, RC, OUT]);
  }

  els.runBtn.addEventListener("click", run);
  drawChart([6,6,6,6]);
</script>
</body>
</html>
